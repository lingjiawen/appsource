import{d as ke,b as x,k as xe,Z as De,_ as Ve,j as Se,o as y,c as F,U as e,O as t,i as Ae,ai as s,aq as W,a as C,u as n,a9 as M,F as X,a8 as ee,M as b,I as w,S as c,T as A,P as g,V as D,bl as Ce,bj as Be}from"./@vue-CIdpUgdv.js";import{l as Ue,a as Ie,d as Fe}from"./sysAttachment-Ck2tH_YR.js";import Me from"./edit-BDOIeclo.js";import{a as te,E as Ne}from"./element-plus-BcbsnzDt.js";import{a as Te}from"./index-Cf93PWEY.js";import"./axios-CdtiCRuU.js";import"./index-CNipAdKq.js";import"./lodash-kx6XzW9U.js";import"./@intlify-BrbEMGpa.js";import"./index-jX4CTekM.js";import"./spark-md5-C5cDV8iz.js";import"./pinia-DE-bJcb2.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CWOL7ATe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-jSNvwxF2.js";import"./nprogress-ekFNJb3B.js";import"./qs-Cbync0Ql.js";import"./side-channel-Bxu5bNZA.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./call-bind-Bt3bzbWQ.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./object-inspect-C4zVfScY.js";import"./vue-i18n-C6ZazF2L.js";import"./vue-BUaMJYO7.js";import"./vue-clipboard3-B4JKg9Nx.js";import"./clipboard-UlwKUFeW.js";import"./mitt-DJ65BbbF.js";import"./vue-grid-layout-CBs1MJUm.js";import"./vue-simple-uploader-DfJosV98.js";import"./vue-ueditor-wrap-DRzi_KnA.js";import"./lodash-es-1chB_st9.js";import"./@vueuse-Dw_h8qVP.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BB1_x23Y.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DSOXY3Ah.js";const $e=V=>(Ce("data-v-2650aeaf"),V=V(),Be(),V),ze={class:"system-sysAttachment-container"},Re={class:"system-sysAttachment-search mb15"},Ye=$e(()=>C("i",{class:"iconfont icon-shangchuan"},null,-1)),Le={class:"image-slot"},Ee=ke({name:"apiV1SystemSysAttachmentList",__name:"index",setup(V){const{proxy:h}=Ae(),B=x(!1),U=x(),N=x(),r=x(!1),le=x(!0),T=x(!0),$=xe(()=>r.value===!1?"展开搜索":"收起搜索"),{sys_upload_drive:z,sys_upload_file_type:R}=h.useDict("sys_upload_drive","sys_upload_file_type"),k=De({ids:[],tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10,appId:void 0,drive:void 0,name:void 0,kind:void 0,mimeType:void 0,status:void 0,createdAt:[],dateRange:[]}}}),{tableData:i}=Ve(k);Se(()=>{ae()});const ae=()=>{f()},Y=o=>{o&&(o.resetFields(),f())},f=()=>{B.value=!0,Ue(k.tableData.param).then(o=>{let l=o.data.list??[];k.tableData.data=l,k.tableData.total=o.data.total,B.value=!1})},L=()=>{r.value=!r.value},oe=o=>h.selectDictLabel(z.value,o.drive),ne=o=>h.selectDictLabel(R.value,o.kind),se=o=>{Ie(o.id,o.status).catch(()=>{setTimeout(()=>{o.status=!o.status},300)})},ie=o=>{k.ids=o.map(l=>l.id),le.value=o.length!=1,T.value=!o.length},I=o=>{N.value.openDialog(o)},re=o=>{window.open(h.getUpFileUrl(o.path))},E=o=>{let l="你确定要删除所选数据？",v=[];if(o?(l="此操作将永久删除数据，是否继续?",v=[o.id]):v=k.ids,v.length===0){te.error("请选择要删除的数据。");return}Ne.confirm(l,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{Fe(v).then(()=>{te.success("删除成功"),f()})}).catch(()=>{})},pe=o=>{const l=o.lastIndexOf(".");return l===-1||l===0?"":o.slice(l+1)},de=o=>{const l=o.size;if(l===0)return"0 Bytes";const v=["Bytes","KB","MB","GB","TB"],m=Math.floor(Math.log(l)/Math.log(1024));return`${(l/Math.pow(1024,m)).toFixed(2)} ${v[m]}`};return(o,l)=>{const v=s("el-input"),m=s("el-form-item"),p=s("el-col"),K=s("el-option"),H=s("el-select"),P=s("ele-Search"),d=s("el-icon"),u=s("el-button"),q=s("ele-Refresh"),j=s("ele-ArrowUp"),O=s("ele-ArrowDown"),G=s("el-switch"),me=s("el-date-picker"),Q=s("el-row"),ue=s("el-form"),ce=s("ele-Upload"),_e=s("ele-PictureFilled"),fe=s("ele-Delete"),_=s("el-table-column"),Z=s("el-image"),ve=s("ele-Download"),ye=s("ele-DeleteFilled"),ge=s("el-table"),he=s("pagination"),be=s("el-card"),J=W("auth"),we=W("loading");return y(),F("div",ze,[e(be,{shadow:"hover"},{default:t(()=>[C("div",Re,[e(ue,{model:n(i).param,ref_key:"queryRef",ref:U,inline:!0,"label-width":"100px"},{default:t(()=>[e(Q,null,{default:t(()=>[e(p,{span:8,class:"colBlock"},{default:t(()=>[e(m,{label:"应用ID",prop:"appId"},{default:t(()=>[e(v,{modelValue:n(i).param.appId,"onUpdate:modelValue":l[0]||(l[0]=a=>n(i).param.appId=a),placeholder:"请输入应用ID",clearable:"",onKeyup:M(f,["enter","native"])},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8,class:"colBlock"},{default:t(()=>[e(m,{label:"上传驱动",prop:"drive"},{default:t(()=>[e(H,{modelValue:n(i).param.drive,"onUpdate:modelValue":l[1]||(l[1]=a=>n(i).param.drive=a),placeholder:"请选择上传驱动",clearable:"",style:{width:"200px"}},{default:t(()=>[(y(!0),F(X,null,ee(n(z),a=>(y(),b(K,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8,class:w(r.value?"colNone":"colBlock")},{default:t(()=>[e(m,null,{default:t(()=>[e(u,{type:"primary",onClick:f},{default:t(()=>[e(d,null,{default:t(()=>[e(P)]),_:1}),c("搜索")]),_:1}),e(u,{onClick:l[2]||(l[2]=a=>Y(U.value))},{default:t(()=>[e(d,null,{default:t(()=>[e(q)]),_:1}),c("重置")]),_:1}),e(u,{type:"primary",link:"",onClick:L},{default:t(()=>[c(A($.value)+" ",1),g(e(d,null,{default:t(()=>[e(j)]),_:1},512),[[D,r.value]]),g(e(d,null,{default:t(()=>[e(O)]),_:1},512),[[D,!r.value]])]),_:1})]),_:1})]),_:1},8,["class"]),e(p,{span:8,class:w(r.value?"colBlock":"colNone")},{default:t(()=>[e(m,{label:"文件原始名",prop:"name"},{default:t(()=>[e(v,{modelValue:n(i).param.name,"onUpdate:modelValue":l[3]||(l[3]=a=>n(i).param.name=a),placeholder:"请输入文件原始名",clearable:"",onKeyup:M(f,["enter","native"])},null,8,["modelValue"])]),_:1})]),_:1},8,["class"]),e(p,{span:8,class:w(r.value?"colBlock":"colNone")},{default:t(()=>[e(m,{label:"上传类型",prop:"kind"},{default:t(()=>[e(H,{modelValue:n(i).param.kind,"onUpdate:modelValue":l[4]||(l[4]=a=>n(i).param.kind=a),placeholder:"请选择上传类型",clearable:"",style:{width:"200px"}},{default:t(()=>[(y(!0),F(X,null,ee(n(R),a=>(y(),b(K,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["class"]),e(p,{span:8,class:w(r.value?"colBlock":"colNone")},{default:t(()=>[e(m,{label:"扩展类型",prop:"mimeType"},{default:t(()=>[e(v,{modelValue:n(i).param.mimeType,"onUpdate:modelValue":l[5]||(l[5]=a=>n(i).param.mimeType=a),placeholder:"请输入扩展类型",clearable:"",onKeyup:M(f,["enter","native"])},null,8,["modelValue"])]),_:1})]),_:1},8,["class"]),e(p,{span:8,class:w(r.value?"colBlock":"colNone")},{default:t(()=>[e(m,{label:"状态",prop:"status"},{default:t(()=>[e(G,{modelValue:n(i).param.status,"onUpdate:modelValue":l[6]||(l[6]=a=>n(i).param.status=a),class:"ml-2"},null,8,["modelValue"])]),_:1})]),_:1},8,["class"]),e(p,{span:8,class:w(r.value?"colBlock":"colNone")},{default:t(()=>[e(m,{label:"创建时间",prop:"createdAt"},{default:t(()=>[e(me,{clearable:"",style:{width:"200px"},modelValue:n(i).param.createdAt,"onUpdate:modelValue":l[7]||(l[7]=a=>n(i).param.createdAt=a),format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])]),_:1})]),_:1},8,["class"]),e(p,{span:8,class:w(r.value?"colBlock":"colNone")},{default:t(()=>[e(m,null,{default:t(()=>[e(u,{type:"primary",onClick:f},{default:t(()=>[e(d,null,{default:t(()=>[e(P)]),_:1}),c("搜索")]),_:1}),e(u,{onClick:l[8]||(l[8]=a=>Y(U.value))},{default:t(()=>[e(d,null,{default:t(()=>[e(q)]),_:1}),c("重置")]),_:1}),e(u,{type:"primary",link:"",onClick:L},{default:t(()=>[c(A($.value)+" ",1),g(e(d,null,{default:t(()=>[e(j)]),_:1},512),[[D,r.value]]),g(e(d,null,{default:t(()=>[e(O)]),_:1},512),[[D,!r.value]])]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},8,["model"]),e(Q,{gutter:10,class:"mb8"},{default:t(()=>[e(p,{span:1.5},{default:t(()=>[e(u,{type:"primary",onClick:l[9]||(l[9]=a=>I("file"))},{default:t(()=>[e(d,null,{default:t(()=>[e(ce)]),_:1}),c("上传文件")]),_:1})]),_:1}),e(p,{span:1.5},{default:t(()=>[e(u,{color:"#626aef",dark:!0,type:"success",onClick:l[10]||(l[10]=a=>I("image"))},{default:t(()=>[e(d,null,{default:t(()=>[e(_e)]),_:1}),c("上传图片")]),_:1})]),_:1}),e(p,{span:1.5},{default:t(()=>[e(u,{type:"success",onClick:l[11]||(l[11]=a=>I("bigFile"))},{default:t(()=>[Ye,c("上传大文件")]),_:1})]),_:1}),e(p,{span:1.5},{default:t(()=>[g((y(),b(u,{type:"danger",disabled:T.value,onClick:l[12]||(l[12]=a=>E(null))},{default:t(()=>[e(d,null,{default:t(()=>[e(fe)]),_:1}),c("删除")]),_:1},8,["disabled"])),[[J,"api/v1/system/sysAttachment/delete"]])]),_:1})]),_:1})]),g((y(),b(ge,{data:n(i).data,onSelectionChange:ie},{default:t(()=>[e(_,{type:"selection",width:"55",align:"center"}),e(_,{label:"文件ID",align:"center",prop:"id","min-width":"80px"}),e(_,{label:"应用ID",align:"center",prop:"appId","min-width":"100px"}),e(_,{label:"上传驱动",align:"center",prop:"drive",formatter:oe,"min-width":"100px"}),e(_,{label:"文件原始名",align:"center",prop:"name","show-overflow-tooltip":"","min-width":"260px"}),e(_,{label:"上传类型",align:"center",prop:"kind",formatter:ne,"min-width":"100px"}),e(_,{label:"本地路径",align:"center",prop:"path","min-width":"100px"},{default:t(a=>[a.row.kind=="image"?(y(),b(Z,{key:0,style:{width:"60px",height:"60px"},src:n(h).getUpFileUrl(a.row.path),"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[n(h).getUpFileUrl(a.row.path)],"initial-index":0,"preview-teleported":"","hide-on-click-modal":"",fit:"fill"},null,8,["src","preview-src-list"])):(y(),b(Z,{key:1,style:{width:"60px",height:"60px"}},{error:t(()=>[C("div",Le,A(pe(a.row.name)),1)]),_:2},1024))]),_:1}),e(_,{label:"文件大小",align:"center",prop:"size",formatter:de,"min-width":"100px"}),e(_,{label:"状态",align:"center",prop:"status","min-width":"150px"},{default:t(a=>[e(G,{modelValue:a.row.status,"onUpdate:modelValue":S=>a.row.status=S,class:"ml-2",onChange:S=>se(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(_,{label:"上传时间",align:"center",prop:"updatedAt","min-width":"150px"},{default:t(a=>[C("span",null,A(n(h).parseTime(a.row.updatedAt,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),e(_,{label:"操作",align:"center","class-name":"small-padding","min-width":"160px",fixed:"right"},{default:t(a=>[e(u,{type:"primary",link:"",onClick:S=>re(a.row)},{default:t(()=>[e(d,null,{default:t(()=>[e(ve)]),_:1}),c("下载")]),_:2},1032,["onClick"]),g((y(),b(u,{type:"primary",link:"",onClick:S=>E(a.row)},{default:t(()=>[e(d,null,{default:t(()=>[e(ye)]),_:1}),c("删除")]),_:2},1032,["onClick"])),[[J,"api/v1/system/sysAttachment/delete"]])]),_:1})]),_:1},8,["data"])),[[we,B.value]]),g(e(he,{total:n(i).total,page:n(i).param.pageNum,"onUpdate:page":l[13]||(l[13]=a=>n(i).param.pageNum=a),limit:n(i).param.pageSize,"onUpdate:limit":l[14]||(l[14]=a=>n(i).param.pageSize=a),onPagination:f},null,8,["total","page","limit"]),[[D,n(i).total>0]])]),_:1}),e(Me,{ref_key:"editRef",ref:N,onSysAttachmentList:f},null,512)])}}}),zt=Te(Ee,[["__scopeId","data-v-2650aeaf"]]);export{zt as default};
