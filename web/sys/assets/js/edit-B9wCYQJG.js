import{g as H,a as Q,u as X}from"./asApplication-cyou5BJm.js";import{u as Y}from"./index-jX4CTekM.js";import{a as z}from"./element-plus-BcbsnzDt.js";import{d as $,b as k,Z as ee,_ as le,o as f,c as v,U as o,O as i,u as t,D as oe,ai as p,aq as te,P as ae,S as c,T as w,a as U,F as B,a8 as I,M as h,bl as ie,bj as de}from"./@vue-CIdpUgdv.js";import{a as re}from"./index-Cf93PWEY.js";import"./lodash-kx6XzW9U.js";import"./@intlify-BrbEMGpa.js";import"./lodash-es-1chB_st9.js";import"./@vueuse-Dw_h8qVP.js";import"./@element-plus-jSNvwxF2.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BB1_x23Y.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DSOXY3Ah.js";import"./pinia-DE-bJcb2.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CWOL7ATe.js";import"./js-cookie-Cz0CWeBA.js";import"./nprogress-ekFNJb3B.js";import"./axios-CdtiCRuU.js";import"./qs-Cbync0Ql.js";import"./side-channel-Bxu5bNZA.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./call-bind-Bt3bzbWQ.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./object-inspect-C4zVfScY.js";import"./vue-i18n-C6ZazF2L.js";import"./vue-BUaMJYO7.js";import"./vue-clipboard3-B4JKg9Nx.js";import"./clipboard-UlwKUFeW.js";import"./mitt-DJ65BbbF.js";import"./vue-grid-layout-CBs1MJUm.js";import"./vue-simple-uploader-DfJosV98.js";import"./vue-ueditor-wrap-DRzi_KnA.js";const x=m=>(ie("data-v-c9448b91"),m=m(),de(),m),ne={class:"appsource-asApplication-edit"},pe=x(()=>U("p",null,"1. 本地上传将存储文件/图标在本地, 需要大量的带宽消耗",-1)),se=x(()=>U("p",null,"2. 解析文件需要临时下载软件包, 请勿解析超大网盘文件包",-1)),ue={class:"dialog-footer"},me=$({name:"ApiV1AppsourceAsApplicationEdit",__name:"edit",props:{typeOptions:{type:Array,default:()=>[]},lockOptions:{type:Array,default:()=>[]},lanzouOptions:{type:Array,default:()=>[]},activeOptions:{type:Array,default:()=>[]}},emits:["asApplicationList"],setup(m,{expose:S,emit:F}){const y=F,O="/",A=k(null);k();const n=ee({loading:!1,isShowDialog:!1,formData:{id:void 0,fileUrl:[],name:void 0,bundleId:void 0,version:void 0,size:void 0,type:void 0,description:void 0,iconUrl:void 0,lock:!1,lanzou:void 0,weigh:void 0,active:!1,note:void 0,createdBy:void 0,updatedBy:void 0,createdAt:void 0,updatedAt:void 0},rules:{fileUrl:[{required:!0,message:"文件地址不能为空",trigger:"blur"}],name:[{required:!0,message:"应用名称不能为空",trigger:"blur"}]}}),{loading:C,isShowDialog:_,formData:a,rules:R}=le(n),L=s=>{q(),s&&H(s.id).then(e=>{const d=e.data;d.fileUrl=d.fileUrl?JSON.parse(d.fileUrl):[],d.type=parseInt(d.type),d.lock=!!d.lock,d.lanzou=""+d.lanzou,d.active=!!d.active,n.formData=d}),n.isShowDialog=!0},V=()=>{n.isShowDialog=!1};S({openDialog:L});const M=()=>{V()},N=()=>{const s=t(A);s&&s.validate(e=>{e&&(n.loading=!0,!n.formData.id||n.formData.id===0?Q(n.formData).then(()=>{z.success("添加成功"),V(),y("asApplicationList")}).finally(()=>{n.loading=!1}):X(n.formData).then(()=>{z.success("修改成功"),V(),y("asApplicationList")}).finally(()=>{n.loading=!1}))})},q=()=>{n.formData={id:void 0,fileUrl:[],name:void 0,bundleId:void 0,version:void 0,size:void 0,type:"",description:void 0,iconUrl:void 0,lock:!1,lanzou:"",weigh:void 0,active:!1,note:void 0,createdBy:void 0,updatedBy:void 0,createdAt:void 0,updatedAt:void 0}},E=s=>{if(s.length>0){const e=s[0];console.log(e),n.formData.fileUrl=e.url,n.formData.name=e.name;let d=e.size/1024;if(d<1024)n.formData.size=d.toFixed(2)+" KB";else{let r=d/1024;if(r<1024)n.formData.size=r.toFixed(2)+" MB";else{let b=r/1024;n.formData.size=b.toFixed(2)+" GB"}}}};return(s,e)=>{const d=p("el-alert"),r=p("el-form-item"),b=p("el-space"),g=p("el-button"),u=p("el-input"),G=p("el-option"),K=p("el-select"),D=p("el-switch"),T=p("el-radio"),j=p("el-radio-group"),J=p("el-input-number"),P=p("el-form"),W=p("el-dialog"),Z=te("drag");return f(),v("div",ne,[o(W,{modelValue:t(_),"onUpdate:modelValue":e[13]||(e[13]=l=>oe(_)?_.value=l:null),width:"800px","close-on-click-modal":!1,"destroy-on-close":!0},{header:i(()=>[ae((f(),v("div",null,[c(w((!t(a).id||t(a).id==0?"添加":"修改")+"应用管理"),1)])),[[Z,[".appsource-asApplication-edit .el-dialog",".appsource-asApplication-edit .el-dialog__header"]]])]),footer:i(()=>[U("div",ue,[o(g,{type:"primary",onClick:N,disabled:t(C)},{default:i(()=>[c("确 定")]),_:1},8,["disabled"]),o(g,{onClick:M},{default:i(()=>[c("取 消")]),_:1})])]),default:i(()=>[o(P,{ref_key:"formRef",ref:A,model:t(a),rules:t(R),"label-width":"120px"},{default:i(()=>[o(b,{fill:""},{default:i(()=>[o(d,{type:"info","show-icon":"",closable:!1},{default:i(()=>[pe,se]),_:1}),o(r,{label:"本地上传包",prop:"fileUrl"},{default:i(()=>[o(Y,{action:t(O)+"api/v1/system/upload/singleFile",limit:1,"onUpdate:modelValue":E},null,8,["action"])]),_:1})]),_:1}),o(r,{label:"文件地址",prop:"fileUrl"},{default:i(()=>[o(u,{modelValue:t(a).fileUrl,"onUpdate:modelValue":e[0]||(e[0]=l=>t(a).fileUrl=l),placeholder:"请输入文件地址或上传"},{append:i(()=>[o(g,null,{default:i(()=>[c("解析文件")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(r,{label:"应用名称",prop:"name"},{default:i(()=>[o(u,{modelValue:t(a).name,"onUpdate:modelValue":e[1]||(e[1]=l=>t(a).name=l),placeholder:"请输入应用名称"},null,8,["modelValue"])]),_:1}),o(r,{label:"包名",prop:"bundleId"},{default:i(()=>[o(u,{modelValue:t(a).bundleId,"onUpdate:modelValue":e[2]||(e[2]=l=>t(a).bundleId=l),placeholder:"请输入包名"},null,8,["modelValue"])]),_:1}),o(r,{label:"版本号",prop:"version"},{default:i(()=>[o(u,{modelValue:t(a).version,"onUpdate:modelValue":e[3]||(e[3]=l=>t(a).version=l),placeholder:"请输入版本号"},null,8,["modelValue"])]),_:1}),o(r,{label:"文件大小",prop:"size"},{default:i(()=>[o(u,{modelValue:t(a).size,"onUpdate:modelValue":e[4]||(e[4]=l=>t(a).size=l),placeholder:"请输入文件大小"},null,8,["modelValue"])]),_:1}),o(r,{label:"类型",prop:"type"},{default:i(()=>[o(K,{filterable:"",clearable:"",modelValue:t(a).type,"onUpdate:modelValue":e[5]||(e[5]=l=>t(a).type=l),placeholder:"请选择类型"},{default:i(()=>[(f(!0),v(B,null,I(m.typeOptions,l=>(f(),h(G,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(r,{label:"描述",prop:"description"},{default:i(()=>[o(u,{modelValue:t(a).description,"onUpdate:modelValue":e[6]||(e[6]=l=>t(a).description=l),placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),o(r,{label:"图标",prop:"iconUrl"},{default:i(()=>[o(u,{modelValue:t(a).iconUrl,"onUpdate:modelValue":e[7]||(e[7]=l=>t(a).iconUrl=l),placeholder:"请输入图标"},null,8,["modelValue"])]),_:1}),o(r,{label:"付费",prop:"lock"},{default:i(()=>[o(D,{modelValue:t(a).lock,"onUpdate:modelValue":e[8]||(e[8]=l=>t(a).lock=l),class:"ml-2"},null,8,["modelValue"])]),_:1}),o(r,{label:"是否蓝奏云链接",prop:"lanzou"},{default:i(()=>[o(j,{modelValue:t(a).lanzou,"onUpdate:modelValue":e[9]||(e[9]=l=>t(a).lanzou=l)},{default:i(()=>[(f(!0),v(B,null,I(m.lanzouOptions,l=>(f(),h(T,{key:l.value,value:l.value},{default:i(()=>[c(w(l.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(r,{label:"权重",prop:"weigh"},{default:i(()=>[o(J,{modelValue:t(a).weigh,"onUpdate:modelValue":e[10]||(e[10]=l=>t(a).weigh=l),placeholder:"请输入权重"},null,8,["modelValue"])]),_:1}),o(r,{label:"是否启用",prop:"active"},{default:i(()=>[o(D,{modelValue:t(a).active,"onUpdate:modelValue":e[11]||(e[11]=l=>t(a).active=l),class:"ml-2"},null,8,["modelValue"])]),_:1}),o(r,{label:"备注",prop:"note"},{default:i(()=>[o(u,{modelValue:t(a).note,"onUpdate:modelValue":e[12]||(e[12]=l=>t(a).note=l),type:"textarea",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),il=re(me,[["__scopeId","data-v-c9448b91"]]);export{il as default};
