import{d as R,b as $,Z as E,_ as P,j as A,o as g,c as h,U as a,O as i,u as s,P as O,V as M,i as j,ai as c,F,a8 as G,T as W,S as _}from"./@vue-CIdpUgdv.js";import{_ as Z}from"./editUser.vue_vue_type_script_setup_true_lang-1RFyqaXj.js";import{b as q,d as H,r as J,c as K}from"./index-Bt4iVw3F.js";import{a as u,E as b}from"./element-plus-BcbsnzDt.js";const Q={class:"system-user-list-container"},ae=R({name:"systemUserList",__name:"userList",props:{deptData:{type:Array,default:()=>[]},param:{type:Object,default:()=>{}},genderData:{type:Array,default:()=>[]}},setup(w,{expose:v}){const x=w,{proxy:S}=j(),{sys_user_sex:C}=S.useDict("sys_user_sex"),m=$(),p=E({ids:[],deptProps:{id:"deptId",children:"children",label:"deptName"},tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10,roleId:void 0,deptId:"",mobile:"",status:"",keyWords:"",dateRange:[]}}}),{tableData:l}=P(p),D=()=>{d()},d=()=>{const e={...p.tableData.param,...x.param};q(e).then(t=>{p.tableData.data=t.data.userList??[],p.tableData.total=t.data.total})},U=()=>{m.value.openDialog()},k=e=>{m.value.openDialog(e)},y=e=>{let t="你确定要删除所选用户？",o=[];if(e?(t=`此操作将永久删除用户：“${e.userName}”，是否继续?`,o=[e.id]):o=p.ids,o.length===0){u.error("请选择要删除的数据。");return}b.confirm(t,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{H(o).then(()=>{u.success("删除成功"),d()})}).catch(()=>{})};A(()=>{D()});const N=e=>{p.ids=e.map(t=>t.id)},B=e=>{b.prompt('请输入"'+e.userName+'"的新密码',"提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(({value:t})=>{if(!t||t==""){u.success("密码不能为空");return}J(e.id,t).then(()=>{u.success("修改成功，新密码是："+t)})}).catch(()=>{})},T=e=>{let t=e.userStatus===1?"启用":"停用";b.confirm('确认要"'+t+'"："'+e.userName+'"用户吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return K(e.id,e.userStatus)}).then(()=>{u.success(t+"成功")}).catch(function(){e.userStatus=e.userStatus===0?1:0})};return v({userList:d,onOpenAddUser:U,onRowDel:y}),(e,t)=>{const o=c("el-table-column"),L=c("el-switch"),f=c("el-button"),V=c("el-table"),z=c("pagination");return g(),h("div",Q,[a(V,{data:s(l).data,style:{width:"100%"},onSelectionChange:N},{default:i(()=>[a(o,{type:"selection",width:"55",align:"center"}),a(o,{type:"index",label:"序号",width:"60"}),a(o,{prop:"userName",label:"账户名称","show-overflow-tooltip":""}),a(o,{prop:"userNickname",label:"用户昵称","show-overflow-tooltip":""}),a(o,{prop:"dept.deptName",label:"部门","show-overflow-tooltip":""}),a(o,{label:"角色",align:"center",prop:"roleInfo","show-overflow-tooltip":!0},{default:i(n=>[(g(!0),h(F,null,G(n.row.roleInfo,(r,I)=>(g(),h("span",{key:"role-"+I},W(r.name+"   "),1))),128))]),_:1}),a(o,{prop:"mobile",label:"手机号","show-overflow-tooltip":""}),a(o,{prop:"userStatus",label:"用户状态","show-overflow-tooltip":""},{default:i(n=>[a(L,{modelValue:n.row.userStatus,"onUpdate:modelValue":r=>n.row.userStatus=r,"inline-prompt":"","active-value":1,"inactive-value":0,"active-text":"启","inactive-text":"禁",onChange:r=>T(n.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(o,{prop:"createdAt",label:"创建时间","show-overflow-tooltip":""}),a(o,{label:"操作",width:"200"},{default:i(n=>[a(f,{size:"small",text:"",type:"primary",onClick:r=>k(n.row)},{default:i(()=>[_("修改")]),_:2},1032,["onClick"]),a(f,{size:"small",text:"",type:"primary",onClick:r=>y(n.row)},{default:i(()=>[_("删除")]),_:2},1032,["onClick"]),a(f,{size:"small",text:"",type:"primary",onClick:r=>B(n.row)},{default:i(()=>[_("重置")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),O(a(z,{total:s(l).total,page:s(l).param.pageNum,"onUpdate:page":t[0]||(t[0]=n=>s(l).param.pageNum=n),limit:s(l).param.pageSize,"onUpdate:limit":t[1]||(t[1]=n=>s(l).param.pageSize=n),onPagination:d},null,8,["total","page","limit"]),[[M,s(l).total>0]]),a(Z,{ref_key:"editUserRef",ref:m,"dept-data":w.deptData,"gender-data":s(C),onGetUserList:d},null,8,["dept-data","gender-data"])])}}});export{ae as _};
