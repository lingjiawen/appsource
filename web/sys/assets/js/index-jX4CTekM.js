import{g as S,a as U}from"./index-Cf93PWEY.js";import{_}from"./lodash-kx6XzW9U.js";import{a as v,E as C}from"./element-plus-BcbsnzDt.js";import{d as D,b as T,Z as V,k as x,i as L,ai as s,o as P,M as R,O as p,a as c,T as k,U as y,S as z}from"./@vue-CIdpUgdv.js";const N=D({name:"uploadFile",props:{action:{type:String,default:""},name:{type:String,default:"file"},method:{type:String,default:"post"},multiple:{type:Boolean,default:!0},showFileList:{type:Boolean,default:!0},drag:{type:Boolean,default:!0},accept:{type:String,default:".txt,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.zip,.rar"},disabled:{type:Boolean,default:!1},listType:{type:String,default:"picture-card"},uploadSize:{type:Number,default:2},limit:{type:Number,default:5},modelValue:{type:Array,default:function(){return[]}}},emits:["update:modelValue"],setup(a,{emit:o}){let t=[];const{proxy:f}=L(),u=T(),m=V({token:S()}),n=x({get:()=>{let e=a.modelValue||[];return e.map(l=>(l.url&&(l.url=f.getUpFileUrl(l.url)),l)),t=_.cloneDeep(e),e},set:e=>{o("update:modelValue",e)}}),d=()=>!0,r=()=>{},i=()=>{v.error("最多可上传"+a.limit+"个文件,已超出最大限制数。")},B=(e,l)=>{t=t.filter(w=>{var g,h;return((g=w.raw)==null?void 0:g.uid)!=((h=l.raw)==null?void 0:h.uid)}),e.code===0?t.push({name:e.data.name,url:e.data.path,fullUrl:e.data.fullPath,fileType:e.data.type,size:e.data.size}):v.error(e.message),F()},b=e=>C.confirm(`您确定要删除 ${e.name} ?`,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>!0,()=>!1),E=e=>{t.splice(t.findIndex(l=>l.name===e.name),1),F()},F=()=>{n.value=t};return{dataFileList:n,handleSuccess:B,beforeRemove:b,handleRemove:E,beforeUpload:d,handleChange:r,handleExceed:i,handlePreview:e=>{window.open(e.url)},upFileRef:u,stopUpFile:()=>{u.value.abort()},dataParam:m}}}),$=c("div",{class:"el-upload__text"},[z(" 拖拽文件至此 或"),c("em",null,"点击上传")],-1),A={class:"el-upload__tip"};function M(a,o,t,f,u,m){const n=s("ele-UploadFilled"),d=s("el-icon"),r=s("el-upload");return P(),R(r,{"file-list":a.dataFileList,"onUpdate:fileList":o[0]||(o[0]=i=>a.dataFileList=i),class:"upload-demo",action:a.action,multiple:a.multiple,drag:a.drag,"on-remove":a.handleRemove,"before-remove":a.beforeRemove,limit:a.limit,"on-exceed":a.handleExceed,"before-upload":a.beforeUpload,"on-change":a.handleChange,"on-success":a.handleSuccess,data:a.dataParam,"on-preview":a.handlePreview,ref:"upFileRef"},{tip:p(()=>[c("div",A," 请上传"+k(a.uploadSize)+"G以内文件(受配置管理文件大小影响) ",1)]),default:p(()=>[y(d,{class:"el-icon--upload"},{default:p(()=>[y(n)]),_:1}),$]),_:1},8,["file-list","action","multiple","drag","on-remove","before-remove","limit","on-exceed","before-upload","on-change","on-success","data","on-preview"])}const H=U(N,[["render",M]]);export{H as u};
