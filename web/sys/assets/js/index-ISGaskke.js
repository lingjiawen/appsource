import{b as G,u as K}from"./sysConfig-CDuH0MiA.js";import{h as z,v as A}from"./@element-plus-jSNvwxF2.js";import{a as b}from"./element-plus-BcbsnzDt.js";import{d as E,b as y,Z as I,j as M,P as O,o as t,c as u,U as c,O as l,ai as n,aq as R,F as v,a8 as h,M as f,R as d,u as k,a as T,S as j}from"./@vue-CIdpUgdv.js";import{a as q}from"./index-Cf93PWEY.js";import"./lodash-es-1chB_st9.js";import"./@vueuse-Dw_h8qVP.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BB1_x23Y.js";import"./@intlify-BrbEMGpa.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DSOXY3Ah.js";import"./pinia-DE-bJcb2.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CWOL7ATe.js";import"./js-cookie-Cz0CWeBA.js";import"./nprogress-ekFNJb3B.js";import"./axios-CdtiCRuU.js";import"./qs-Cbync0Ql.js";import"./side-channel-Bxu5bNZA.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./call-bind-Bt3bzbWQ.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./object-inspect-C4zVfScY.js";import"./vue-i18n-C6ZazF2L.js";import"./vue-BUaMJYO7.js";import"./vue-clipboard3-B4JKg9Nx.js";import"./clipboard-UlwKUFeW.js";import"./mitt-DJ65BbbF.js";import"./vue-grid-layout-CBs1MJUm.js";import"./vue-simple-uploader-DfJosV98.js";import"./vue-ueditor-wrap-DRzi_KnA.js";const Y={class:"appsource-sysConfig-container"},Z={class:"del-config-form-item"},$={class:"footer"},H=E({name:"apiV1AppsourceConfigList",__name:"index",props:{sysYesNoOptions:{type:Array,default:()=>[]}},emits:["dataList"],setup(J,{emit:Q}){y(null);const w=y(!1),o=I({isShowDialog:!1,labelPosition:"top",config:[],configGroup:{},activeTab:"appsource"});M(()=>{V()});const V=()=>{G({}).then(r=>{let a=r.data.list??[],s=r.data.groups??[];o.config=a,o.configGroup=s,Object.keys(o.config).forEach(i=>{o.config[i]=o.config[i].map(m=>({...m,configValue:m.elementType==="switch"?m.configValue==="1":m.configValue}))}),console.log(a),console.log(s);for(const i in o.configGroup){o.activeTab=i;break}})},x=()=>{if(!o.activeTab||!o.config[o.activeTab]){b.warning("没有可提交的数据");return}let r=o.config[o.activeTab].map(a=>({configId:a.configId,configKey:a.configKey,configValue:a.elementType==="switch"?a.configValue?1:0:a.configValue,elementType:a.elementType,group:a.group}));K(r).then(()=>{b.success("修改成功"),V()}).catch(a=>{console.error("提交失败",a),b.error("修改失败")})},N=r=>{if(r=="add_config")return o.showAddForm=!0,!1};return(r,a)=>{const s=n("el-input"),i=n("el-form-item"),m=n("el-switch"),U=n("el-image"),C=n("ele-DeleteFilled"),D=n("el-icon"),B=n("el-popconfirm"),P=n("el-button"),F=n("el-tab-pane"),L=n("el-tabs"),S=R("loading");return O((t(),u("div",Y,[c(L,{modelValue:o.activeTab,"onUpdate:modelValue":a[1]||(a[1]=g=>o.activeTab=g),type:"border-card","before-leave":N},{default:l(()=>[(t(!0),u(v,null,h(o.configGroup,(g,_)=>(t(),f(F,{class:"config-tab-pane",key:_,name:_,label:g},{default:l(()=>[(t(!0),u(v,null,h(o.config[_]||{},(e,W)=>(t(),u("div",{class:"config-form-item",key:e.configKey},[e.elementType=="string"?(t(),f(i,{key:0,"label-position":o.labelPosition,label:e.configName+" ("+e.configKey+") ",prop:"item.configName"},{default:l(()=>[c(s,{modelValue:e.configValue,"onUpdate:modelValue":p=>e.configValue=p,placeholder:e.remark},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label-position","label"])):d("",!0),e.elementType=="switch"?(t(),f(i,{key:1,"label-position":o.labelPosition,label:e.configName+" ("+e.configKey+") ",prop:"item.configName"},{default:l(()=>[c(m,{modelValue:e.configValue,"onUpdate:modelValue":p=>e.configValue=p,"inline-prompt":"","active-action-icon":k(z),"inactive-action-icon":k(A),size:"large"},null,8,["modelValue","onUpdate:modelValue","active-action-icon","inactive-action-icon"])]),_:2},1032,["label-position","label"])):d("",!0),e.elementType=="textarea"?(t(),f(i,{key:2,"label-position":o.labelPosition,label:e.configName+" ("+e.configKey+") ",prop:"item.configName"},{default:l(()=>[c(s,{modelValue:e.configValue,"onUpdate:modelValue":p=>e.configValue=p,placeholder:e.remark,type:"textarea",autosize:{minRows:4,maxRows:10}},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label-position","label"])):d("",!0),e.elementType=="image"?(t(),f(i,{key:3,"label-position":o.labelPosition,label:e.configName+" ("+e.configKey+") ",prop:"item.configName"},{default:l(()=>[c(s,{modelValue:e.configValue,"onUpdate:modelValue":p=>e.configValue=p,placeholder:e.remark},{append:l(()=>[c(U,{src:e.configValue,style:{"max-width":"64px"}},null,8,["src"])]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label-position","label"])):d("",!0),T("div",Z,[e.allowDel==1?(t(),f(B,{key:0,confirmButtonText:"删除",title:"确定要删除该配置项吗?"},{reference:l(()=>[c(D,{color:"red",size:"20",class:"el-icon--delete"},{default:l(()=>[c(C)]),_:1})]),_:1})):d("",!0)])]))),128)),T("div",$,[c(P,{type:"primary",onClick:a[0]||(a[0]=e=>x())},{default:l(()=>[j("保存")]),_:1})])]),_:2},1032,["name","label"]))),128))]),_:1},8,["modelValue"])])),[[S,w.value]])}}}),Re=q(H,[["__scopeId","data-v-8bb7ecce"]]);export{Re as default};
