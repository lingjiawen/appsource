import{g as W,a as Z,b as H,u as J}from"./sysNotice-C7br5zb9.js";import{G as K}from"./index-1OT6ILAh.js";import{a as w}from"./element-plus-BcbsnzDt.js";import{d as Q,b as x,Z as X,_ as Y,j as $,o as p,c as f,U as a,O as r,u as e,D as ee,ai as m,aq as te,P as oe,a as U,T as le,S as L,M as _,F as S,a8 as O,R as ie}from"./@vue-CIdpUgdv.js";import{a as ae}from"./index-Cf93PWEY.js";import"./lodash-es-1chB_st9.js";import"./@vueuse-Dw_h8qVP.js";import"./@element-plus-jSNvwxF2.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BB1_x23Y.js";import"./@intlify-BrbEMGpa.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DSOXY3Ah.js";import"./pinia-DE-bJcb2.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CWOL7ATe.js";import"./js-cookie-Cz0CWeBA.js";import"./nprogress-ekFNJb3B.js";import"./axios-CdtiCRuU.js";import"./qs-Cbync0Ql.js";import"./side-channel-Bxu5bNZA.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./call-bind-Bt3bzbWQ.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./object-inspect-C4zVfScY.js";import"./vue-i18n-C6ZazF2L.js";import"./vue-BUaMJYO7.js";import"./vue-clipboard3-B4JKg9Nx.js";import"./clipboard-UlwKUFeW.js";import"./mitt-DJ65BbbF.js";import"./vue-grid-layout-CBs1MJUm.js";import"./vue-simple-uploader-DfJosV98.js";import"./vue-ueditor-wrap-DRzi_KnA.js";const re={class:"system-sysNotice-edit"},se={style:{"font-weight":"500","font-size":"18px",color:"rgb(31 34 37)"}},de={class:"dialog-footer"},ne=Q({name:"NoticeMessageEdit",__name:"NoticeMessageEdit",props:{tagOptions:{type:Array,default:()=>[]}},emits:["sysNoticeList"],setup(B,{expose:C,emit:q}){const y=q,b=x(null);x();const l=X({loading:!1,isShowDialog:!1,title:"",userListOptions:[],formData:{id:void 0,receiver:void 0,title:void 0,type:void 0,tag:void 0,content:void 0,remark:void 0,sort:void 0,status:0,createdBy:void 0,updatedBy:void 0,createdAt:void 0,updatedAt:void 0,deletedAt:void 0},rules:{id:[{required:!0,message:"ID不能为空",trigger:"blur"}],title:[{required:!0,message:"标题不能为空",trigger:"blur"}],type:[{required:!0,message:"类型不能为空",trigger:"blur"}],content:[{required:!0,message:"内容不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"blur"}]}}),{isShowDialog:g,formData:i,loading:V,userListOptions:A,rules:M,title:E}=Y(l);$(()=>{D("")});const I=d=>{G(),d&&Z(d.id).then(o=>{const s=o.data;if(s.type=parseInt(s.type),s.type===2&&s.receiverUser){const n=[...l.userListOptions,...s.receiverUser];let c=new Set(n.map(u=>u.id));l.userListOptions=n.filter((u,N,h)=>c.has(u.id)&&c.delete(u.id))}s.tag=""+s.tag,s.status=parseInt(s.status),l.formData=s}),l.isShowDialog=!0},D=d=>{l.userListOptions=[],W(d).then(o=>{l.userListOptions=o.data.userList})},R=d=>{l.formData.type=d,d==1?l.title="通知":d==2&&(l.title="私信")},v=()=>{l.isShowDialog=!1},F=()=>{v()},T=()=>{const d=e(b);d&&d.validate(o=>{o&&(l.loading=!0,!l.formData.id||l.formData.id===0?H(l.formData).then(()=>{w.success("添加成功"),v(),y("sysNoticeList")}).finally(()=>{l.loading=!1}):J(l.formData).then(()=>{w.success("修改成功"),v(),y("sysNoticeList")}).finally(()=>{l.loading=!1}))})},G=()=>{l.formData={receiver:void 0,type:void 0,id:void 0,title:void 0,tag:void 0,content:void 0,remark:void 0,sort:0,status:1,createdBy:void 0,updatedBy:void 0,createdAt:void 0,updatedAt:void 0,deletedAt:void 0}};return C({openDialog:I,setType:R}),(d,o)=>{const s=m("el-input"),n=m("el-form-item"),c=m("el-option"),u=m("el-select"),N=m("el-switch"),h=m("el-input-number"),j=m("el-form"),k=m("el-button"),z=m("el-dialog"),P=te("drag");return p(),f("div",re,[a(z,{modelValue:e(g),"onUpdate:modelValue":o[7]||(o[7]=t=>ee(g)?g.value=t:null),width:"800px","close-on-click-modal":!1,"destroy-on-close":!0},{header:r(()=>[oe((p(),f("div",null,[U("span",se,le((!e(i).id||e(i).id==0?"发送":"修改")+e(E)),1)])),[[P,[".system-sysNotice-edit .el-dialog",".system-sysNotice-edit .el-dialog__header"]]])]),footer:r(()=>[U("div",de,[a(k,{type:"primary",onClick:T,disabled:e(V)},{default:r(()=>[L("确 定")]),_:1},8,["disabled"]),a(k,{onClick:F},{default:r(()=>[L("取 消")]),_:1})])]),default:r(()=>[a(j,{ref_key:"formRef",ref:b,model:e(i),rules:e(M),"label-width":"80px"},{default:r(()=>[a(n,{label:"标题",prop:"title"},{default:r(()=>[a(s,{modelValue:e(i).title,"onUpdate:modelValue":o[0]||(o[0]=t=>e(i).title=t),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),e(i).type==2?(p(),_(n,{key:0,label:"接收用户"},{default:r(()=>[a(u,{style:{width:"100%"},modelValue:e(i).receiver,"onUpdate:modelValue":o[1]||(o[1]=t=>e(i).receiver=t),multiple:"",filterable:"",remote:"","reserve-keyword":"",placeholder:"可输入要指定的用户名称搜索","remote-method":D,loading:e(V)},{default:r(()=>[(p(!0),f(S,null,O(e(A),t=>(p(),_(c,{key:t.id,label:t.userNickname,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})):ie("",!0),a(n,{label:"标签",prop:"tag"},{default:r(()=>[a(u,{modelValue:e(i).tag,"onUpdate:modelValue":o[2]||(o[2]=t=>e(i).tag=t),placeholder:"请选择标签"},{default:r(()=>[(p(!0),f(S,null,O(B.tagOptions,t=>(p(),_(c,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(n,{label:"内容"},{default:r(()=>[a(K,{editorId:"ueSysNoticeContent",modelValue:e(i).content,"onUpdate:modelValue":o[3]||(o[3]=t=>e(i).content=t)},null,8,["modelValue"])]),_:1}),a(n,{label:"状态",prop:"status"},{default:r(()=>[a(N,{modelValue:e(i).status,"onUpdate:modelValue":o[4]||(o[4]=t=>e(i).status=t),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-value":1,"inactive-value":0,"active-text":"正常","inactive-text":"停用"},null,8,["modelValue"])]),_:1}),a(n,{label:"备注",prop:"remark"},{default:r(()=>[a(s,{"show-word-limit":"",maxlength:"200",modelValue:e(i).remark,"onUpdate:modelValue":o[5]||(o[5]=t=>e(i).remark=t),type:"textarea",placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),a(n,{label:"排序",prop:"sort"},{default:r(()=>[a(h,{type:"num",modelValue:e(i).sort,"onUpdate:modelValue":o[6]||(o[6]=t=>e(i).sort=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),tt=ae(ne,[["__scopeId","data-v-ac39260d"]]);export{tt as default};
