import{d as we,b as h,k as Ce,Z as xe,_ as De,j as Ve,o as u,c as N,U as e,O as t,u as s,i as Se,ai as n,aq as W,a as Je,a9 as ze,F as X,a8 as Y,M as _,I as O,S as m,T as ee,P as c,V as C,ae as te}from"./@vue-CIdpUgdv.js";import{l as Ie,r as Be,c as Ne,s as Oe,e as Pe}from"./sysJob-C4O8EjPY.js";import Re from"./edit-CP8oTkKS.js";import Ge from"./detail-BBSOd5KQ.js";import{E as P,a as D}from"./element-plus-BcbsnzDt.js";import{a as Ue}from"./index-Cf93PWEY.js";import"./lodash-es-1chB_st9.js";import"./@vueuse-Dw_h8qVP.js";import"./@element-plus-jSNvwxF2.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BB1_x23Y.js";import"./@intlify-BrbEMGpa.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DSOXY3Ah.js";import"./pinia-DE-bJcb2.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CWOL7ATe.js";import"./js-cookie-Cz0CWeBA.js";import"./nprogress-ekFNJb3B.js";import"./axios-CdtiCRuU.js";import"./qs-Cbync0Ql.js";import"./side-channel-Bxu5bNZA.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./call-bind-Bt3bzbWQ.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./object-inspect-C4zVfScY.js";import"./vue-i18n-C6ZazF2L.js";import"./vue-BUaMJYO7.js";import"./vue-clipboard3-B4JKg9Nx.js";import"./clipboard-UlwKUFeW.js";import"./mitt-DJ65BbbF.js";import"./vue-grid-layout-CBs1MJUm.js";import"./vue-simple-uploader-DfJosV98.js";import"./vue-ueditor-wrap-DRzi_KnA.js";const Te={class:"system-sysJob-container"},Ee={class:"system-sysJob-search mb15"},$e=we({name:"apiV1SystemSysJobList",__name:"index",setup(Fe){const{proxy:V}=Se(),S=h(!1),J=h(),z=h(),R=h(),d=h(!1),G=h(!0),U=h(!0),T=Ce(()=>d.value===!1?"展开搜索":"收起搜索"),{sys_job_group:x,sys_job_policy:I,sys_job_status:B}=V.useDict("sys_job_group","sys_job_policy","sys_job_status"),y=xe({jobIds:[],tableData:{data:[],total:0,loading:!1,param:{pageNum:1,pageSize:10,jobName:void 0,jobGroup:void 0,status:void 0}}}),{tableData:r}=De(y);Ve(()=>{le()});const le=()=>{f()},E=l=>{l&&(l.resetFields(),f())},f=()=>{S.value=!0,Ie(y.tableData.param).then(l=>{let o=l.data.list??[];y.tableData.data=o,y.tableData.total=l.data.total,S.value=!1})},$=()=>{d.value=!d.value},oe=l=>V.selectDictLabel(x.value,l.jobGroup),ae=l=>V.selectDictLabel(I.value,l.misfirePolicy),ne=l=>{y.jobIds=l.map(o=>o.jobId),G.value=l.length!=1,U.value=!l.length},se=()=>{z.value.openDialog()},F=l=>{l||(l=y.tableData.data.find(o=>o.jobId===y.jobIds[0])),z.value.openDialog(te(l))},ie=l=>{const o=l.jobId||0;P.confirm("是否确认立即执行一次该任务?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return Be(o)}).then(()=>{D.success("执行成功")}).catch(function(){})},L=l=>{let o="你确定要删除所选数据？",k=[];if(l?(o="此操作将永久删除数据，是否继续?",k=[l.jobId]):k=y.jobIds,k.length===0){D.error("请选择要删除的数据。");return}P.confirm(o,"提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{Ne(k).then(()=>{D.success("删除成功"),f()})}).catch(()=>{})},re=l=>{R.value.openDialog(te(l))},pe=l=>{let o=l.status===0?"启用":"停用";P.confirm('确认要"'+o+'""'+l.jobName+'"任务吗?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){return l.status===0?Oe(l.jobId):Pe(l.jobId)}).then(()=>{D.success(o+"成功")}).catch(function(){l.status=l.status===0?1:0})};return(l,o)=>{const k=n("el-input"),w=n("el-form-item"),v=n("el-col"),A=n("el-option"),M=n("el-select"),q=n("ele-Search"),i=n("el-icon"),p=n("el-button"),K=n("ele-Refresh"),Q=n("ele-ArrowUp"),Z=n("ele-ArrowDown"),H=n("el-row"),ue=n("el-form"),me=n("ele-Plus"),ce=n("ele-Edit"),de=n("ele-Delete"),b=n("el-table-column"),_e=n("el-switch"),fe=n("ele-View"),be=n("ele-EditPen"),ye=n("ele-CaretRight"),ve=n("ele-DeleteFilled"),ge=n("el-table"),he=n("pagination"),ke=n("el-card"),g=W("auth"),je=W("loading");return u(),N("div",Te,[e(ke,{shadow:"hover"},{default:t(()=>[Je("div",Ee,[e(ue,{model:s(r).param,ref_key:"queryRef",ref:J,inline:!0,"label-width":"100px"},{default:t(()=>[e(H,null,{default:t(()=>[e(v,{span:8,class:"colBlock"},{default:t(()=>[e(w,{label:"任务名称",prop:"jobName"},{default:t(()=>[e(k,{modelValue:s(r).param.jobName,"onUpdate:modelValue":o[0]||(o[0]=a=>s(r).param.jobName=a),placeholder:"请输入任务名称",clearable:"",onKeyup:ze(f,["enter","native"])},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:8,class:"colBlock"},{default:t(()=>[e(w,{label:"任务组名",prop:"jobGroup"},{default:t(()=>[e(M,{modelValue:s(r).param.jobGroup,"onUpdate:modelValue":o[1]||(o[1]=a=>s(r).param.jobGroup=a),placeholder:"请选择任务组名",clearable:"",style:{width:"160px"}},{default:t(()=>[(u(!0),N(X,null,Y(s(x),a=>(u(),_(A,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(v,{span:8,class:O(d.value?"colNone":"colBlock")},{default:t(()=>[e(w,null,{default:t(()=>[e(p,{type:"primary",size:"small",onClick:f},{default:t(()=>[e(i,null,{default:t(()=>[e(q)]),_:1}),m("搜索")]),_:1}),e(p,{size:"small",onClick:o[2]||(o[2]=a=>E(J.value))},{default:t(()=>[e(i,null,{default:t(()=>[e(K)]),_:1}),m("重置")]),_:1}),e(p,{type:"primary",link:"",size:"small",onClick:$},{default:t(()=>[m(ee(T.value)+" ",1),c(e(i,null,{default:t(()=>[e(Q)]),_:1},512),[[C,d.value]]),c(e(i,null,{default:t(()=>[e(Z)]),_:1},512),[[C,!d.value]])]),_:1})]),_:1})]),_:1},8,["class"]),e(v,{span:8,class:O(d.value?"colBlock":"colNone")},{default:t(()=>[e(w,{label:"状态",prop:"status"},{default:t(()=>[e(M,{modelValue:s(r).param.status,"onUpdate:modelValue":o[3]||(o[3]=a=>s(r).param.status=a),placeholder:"请选择状态",clearable:"",style:{width:"160px"}},{default:t(()=>[(u(!0),N(X,null,Y(s(B),a=>(u(),_(A,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["class"]),e(v,{span:8,class:O(d.value?"colBlock":"colNone")},{default:t(()=>[e(w,null,{default:t(()=>[e(p,{type:"primary",size:"small",onClick:f},{default:t(()=>[e(i,null,{default:t(()=>[e(q)]),_:1}),m("搜索")]),_:1}),e(p,{size:"small",onClick:o[4]||(o[4]=a=>E(J.value))},{default:t(()=>[e(i,null,{default:t(()=>[e(K)]),_:1}),m("重置")]),_:1}),e(p,{type:"primary",link:"",size:"small",onClick:$},{default:t(()=>[m(ee(T.value)+" ",1),c(e(i,null,{default:t(()=>[e(Q)]),_:1},512),[[C,d.value]]),c(e(i,null,{default:t(()=>[e(Z)]),_:1},512),[[C,!d.value]])]),_:1})]),_:1})]),_:1},8,["class"])]),_:1})]),_:1},8,["model"]),e(H,{gutter:10,class:"mb8"},{default:t(()=>[e(v,{span:1.5},{default:t(()=>[c((u(),_(p,{type:"primary",size:"small",onClick:se},{default:t(()=>[e(i,null,{default:t(()=>[e(me)]),_:1}),m("新增")]),_:1})),[[g,"api/v1/system/sysJob/add"]])]),_:1}),e(v,{span:1.5},{default:t(()=>[c((u(),_(p,{type:"success",size:"small",disabled:G.value,onClick:o[5]||(o[5]=a=>F(null))},{default:t(()=>[e(i,null,{default:t(()=>[e(ce)]),_:1}),m("修改")]),_:1},8,["disabled"])),[[g,"api/v1/system/sysJob/edit"]])]),_:1}),e(v,{span:1.5},{default:t(()=>[c((u(),_(p,{type:"danger",size:"small",disabled:U.value,onClick:o[6]||(o[6]=a=>L(null))},{default:t(()=>[e(i,null,{default:t(()=>[e(de)]),_:1}),m("删除")]),_:1},8,["disabled"])),[[g,"api/v1/system/sysJob/delete"]])]),_:1})]),_:1})]),c((u(),_(ge,{data:s(r).data,onSelectionChange:ne},{default:t(()=>[e(b,{type:"selection",width:"55",align:"center"}),e(b,{label:"任务ID",align:"center",prop:"jobId","min-width":"100px"}),e(b,{label:"任务名称",align:"center",prop:"jobName","min-width":"100px"}),e(b,{label:"任务组名",align:"center",prop:"jobGroup",formatter:oe,"min-width":"100px"}),e(b,{label:"任务方法",align:"center",prop:"invokeTarget","min-width":"100px"}),e(b,{label:"cron执行表达式",align:"center",prop:"cronExpression","min-width":"100px"}),e(b,{label:"计划执行策略",align:"center",prop:"misfirePolicy",formatter:ae,"min-width":"100px"}),e(b,{label:"状态",align:"center"},{default:t(a=>[e(_e,{modelValue:a.row.status,"onUpdate:modelValue":j=>a.row.status=j,"active-value":0,"inactive-value":1,onChange:j=>pe(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(b,{label:"操作",align:"center","class-name":"small-padding","min-width":"200px",fixed:"right"},{default:t(a=>[c((u(),_(p,{size:"small",type:"primary",link:"",onClick:j=>re(a.row)},{default:t(()=>[e(i,null,{default:t(()=>[e(fe)]),_:1}),m("详情")]),_:2},1032,["onClick"])),[[g,"api/v1/system/sysJob/view"]]),c((u(),_(p,{size:"small",type:"primary",link:"",onClick:j=>F(a.row)},{default:t(()=>[e(i,null,{default:t(()=>[e(be)]),_:1}),m("修改")]),_:2},1032,["onClick"])),[[g,"api/v1/system/sysJob/edit"]]),c((u(),_(p,{size:"small",type:"primary",link:"",onClick:j=>ie(a.row)},{default:t(()=>[e(i,null,{default:t(()=>[e(ye)]),_:1}),m("执行一次")]),_:2},1032,["onClick"])),[[g,"api/v1/system/sysJob/run"]]),c((u(),_(p,{size:"small",type:"primary",link:"",onClick:j=>L(a.row)},{default:t(()=>[e(i,null,{default:t(()=>[e(ve)]),_:1}),m("删除")]),_:2},1032,["onClick"])),[[g,"api/v1/system/sysJob/delete"]])]),_:1})]),_:1},8,["data"])),[[je,S.value]]),c(e(he,{total:s(r).total,page:s(r).param.pageNum,"onUpdate:page":o[7]||(o[7]=a=>s(r).param.pageNum=a),limit:s(r).param.pageSize,"onUpdate:limit":o[8]||(o[8]=a=>s(r).param.pageSize=a),onPagination:f},null,8,["total","page","limit"]),[[C,s(r).total>0]])]),_:1}),e(Re,{ref_key:"editRef",ref:z,jobGroupOptions:s(x),misfirePolicyOptions:s(I),statusOptions:s(B),onSysJobList:f},null,8,["jobGroupOptions","misfirePolicyOptions","statusOptions"]),e(Ge,{ref_key:"detailRef",ref:R,jobGroupOptions:s(x),misfirePolicyOptions:s(I),statusOptions:s(B),onSysJobList:f},null,8,["jobGroupOptions","misfirePolicyOptions","statusOptions"])])}}}),Pt=Ue($e,[["__scopeId","data-v-7347d9e0"]]);export{Pt as default};
