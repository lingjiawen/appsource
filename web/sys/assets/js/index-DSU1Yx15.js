import{s as B,a as I}from"./index-Cf93PWEY.js";import{E as W}from"./element-plus-BcbsnzDt.js";import{d as z,Z as v,b as y,o as E,c as N,U as e,O as o,ai as i,S as _,bl as R,bj as q,a as w}from"./@vue-CIdpUgdv.js";import"./pinia-DE-bJcb2.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-CWOL7ATe.js";import"./js-cookie-Cz0CWeBA.js";import"./@element-plus-jSNvwxF2.js";import"./nprogress-ekFNJb3B.js";import"./@intlify-BrbEMGpa.js";import"./axios-CdtiCRuU.js";import"./qs-Cbync0Ql.js";import"./side-channel-Bxu5bNZA.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./call-bind-Bt3bzbWQ.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./object-inspect-C4zVfScY.js";import"./vue-i18n-C6ZazF2L.js";import"./vue-BUaMJYO7.js";import"./vue-clipboard3-B4JKg9Nx.js";import"./clipboard-UlwKUFeW.js";import"./mitt-DJ65BbbF.js";import"./vue-grid-layout-CBs1MJUm.js";import"./vue-simple-uploader-DfJosV98.js";import"./vue-ueditor-wrap-DRzi_KnA.js";import"./lodash-es-1chB_st9.js";import"./@vueuse-Dw_h8qVP.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-BB1_x23Y.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-DSOXY3Ah.js";const h=u=>(R("data-v-d79e3371"),u=u(),q(),u),j=h(()=>w("div",{class:"my-title"},"生产者",-1)),F=h(()=>w("div",{class:"my-title"},"消费者",-1)),L=z({__name:"index",setup(u){const a=v({topic:"producer_topic_test",body:"测试消息队列内容",channel:"channel1"});v({topic:"producer_topic_test",channel:"channel1"});function S(){B({url:"/api/v1/mqueue/demo/produce",method:"post",data:{topic:a.topic,body:a.body}}).then(r=>{window.console.log(r)})}const V="",m=y("");let t=null;const n=y(!1);function x(){if(t)return;const r=V+"api/v1/mqueue/demo/subscribe?topic="+a.topic+"&channel="+a.channel;t=new WebSocket(r);try{t.onopen=function(){m.value+="WebSocket Server ["+r+`] 连接成功！\r
`,n.value=!0},t.onclose=function(){t&&(t.close(),t=null,n.value=!1),m.value+="WebSocket Server ["+r+`] 连接被服务器关闭！\r
`},t.onerror=function(){t&&(t.close(),t=null,n.value=!1),m.value+="WebSocket Server ["+r+`] 连接错误！\r
`},t.onmessage=function(l){window.console.log(l),m.value+=" > "+l.data+`\r
`}}catch(l){W.alert(l.message)}}function k(){t&&(t.close(),t=null,n.value=!1,m.value+=`已手动取消订阅！\r
`)}return(r,l)=>{const g=i("el-alert"),s=i("el-input"),p=i("el-form-item"),c=i("el-button"),f=i("el-form"),b=i("el-col"),U=i("el-row"),C=i("el-card");return E(),N("div",null,[e(C,null,{default:o(()=>[e(g,{type:"error",title:"消息队列测试，先生产一条消息再订阅，先订阅不存在的topic会失败",closable:!1}),e(U,{gutter:20,style:{"margin-top":"20px"}},{default:o(()=>[e(b,{span:10},{default:o(()=>[j,e(f,{"label-width":80},{default:o(()=>[e(p,{label:"topic"},{default:o(()=>[e(s,{modelValue:a.topic,"onUpdate:modelValue":l[0]||(l[0]=d=>a.topic=d)},null,8,["modelValue"])]),_:1}),e(p,{label:"topic"},{default:o(()=>[e(s,{modelValue:a.body,"onUpdate:modelValue":l[1]||(l[1]=d=>a.body=d),type:"textarea",rows:6},null,8,["modelValue"])]),_:1}),e(p,null,{default:o(()=>[e(c,{type:"primary",size:"default",onClick:S},{default:o(()=>[_("生产消息")]),_:1})]),_:1})]),_:1})]),_:1}),e(b,{span:14},{default:o(()=>[F,e(f,{"label-width":80},{default:o(()=>[e(p,{label:"topic"},{default:o(()=>[e(s,{modelValue:a.topic,"onUpdate:modelValue":l[2]||(l[2]=d=>a.topic=d),disabled:n.value},null,8,["modelValue","disabled"])]),_:1}),e(p,{label:"channel"},{default:o(()=>[e(s,{modelValue:a.channel,"onUpdate:modelValue":l[3]||(l[3]=d=>a.channel=d),disabled:n.value},null,8,["modelValue","disabled"])]),_:1}),e(p,null,{default:o(()=>[e(c,{size:"default",type:"primary",onClick:x,disabled:n.value},{default:o(()=>[_("订阅消费")]),_:1},8,["disabled"]),e(c,{size:"default",type:"primary",onClick:k,disabled:!n.value},{default:o(()=>[_("取消订阅")]),_:1},8,["disabled"])]),_:1}),e(p,{label:"消费结果"},{default:o(()=>[e(s,{"model-value":m.value,type:"textarea",rows:12},null,8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Be=I(L,[["__scopeId","data-v-d79e3371"]]);export{Be as default};
